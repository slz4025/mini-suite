<div
  id="editor"
  class="section"
  hx-put="/editor"
  hx-trigger="editor from:body"
  hx-target="this"
  hx-swap="outerHTML"
  style="display: {{ 'none' if not show_editor else 'inherit' }};"
>
  <h2>EDITOR</h2>

  {% if show_help %}
  <p>
    Click on a cell or navigate around using
    Tab (right), Shift+Tab (left), Enter (down), Shift+Enter (up)
    to change the cell in focus.
  </p>
  <p>
    By default, you can input basic values like boolean (True/False),
    integers, floats, and strings. You can also input markdown by
    starting the text with '!'. Write a formula in Python by starting
    the text with a '='.
  </p>
  <p>
    Within your formula, you can refer to a selection of other cells:
  </p>
  <ul>
    <li>single row: <code>&lt;R#r&gt;</code>,</li>
    <li>multiple rows: <code>&lt;R#rs:re&gt;</code>,</li>
    <li>single column: <code>&lt;C#c&gt;</code>,</li>
    <li>multiple columns: <code>&lt;C#cs:ce&gt;</code>,</li>
    <li>single cell: <code>&lt;R#r&gt;&lt;C#c&gt;</code>,</li>
    <li>box of cells: <code>&lt;R#rs:re&gt;&lt;C#cs:ce&gt;</code>,</li>
  </ul>
  <p>
    where
  </p>
  <ul style="padding-bottom: 0.5rem;">
    <li><code>r</code> = expression for index of row,</li>
    <li><code>c</code> = expression for index of col,</li>
    <li><code>rs</code> = expression for inclusive-start index of row range,</li>
    <li><code>re</code> = expression for inclusive-end index of row range,</li>
    <li><code>cs</code> = expression for inclusive-start index of column range,</li>
    <li><code>ce</code> = expression for inclusive-end index of column range.</li>
  </ul>
  <p>
    Within your selection, you can refer to the index for:
  </p>
  <ul>
    <li>current cell's row: <code>&lt;ROW&gt;</code>,</li>
    <li>current cell's column: <code>&lt;COL&gt;</code>.</li>
  </ul>
  {% endif %}

  {% if editing %}
  {{ operations|safe }}

  <form
    hx-put="/cell/{{ row }}/{{ col }}/update"
    hx-target="#cell-{{ row }}-{{ col }}"
    hx-swap="outerHTML"
    enctype="multipart/form-data"
  >
    <textarea
      id="editor-contents"
      name="input-cell-{{ row }}-{{ col }}"
      rows=5,
      style="width: 100%;"
      >{{ data }}</textarea>
    <input
      id="editor-submit"
      type="submit"
      value="â†µ"
    />
  </form>
  {% endif %}
</div>
